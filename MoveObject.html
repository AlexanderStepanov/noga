<!DOCTYPE html>
<html>

<head>
    <script type="text/javascript" src="scripts/jquery-2.0.3.min.js"></script>
    <script type="text/javascript">
        var _shipX = 0;
        var _shipY = 0;
        var _nextPoint = new Object();
        var _isMoving = false;
        var _delay = 0;
        var _moveQueue = new Array();

        $(document).ready(function() {
            startMoving();
        });

        function startMoving() {
            setCoordinates(100, 100);

            for(var i = 0; i <= 360 * 3; i++){
                setAngle(i, 100, 100);


            }
           

        }

//        function drawCircle(selector, center, radius, angle, x, y) {
//            var total = $(selector).length;
//            var alpha = Math.PI * 2 / total;
//            angle *= Math.PI / 180;
//
//            $(selector).each(function(index) {
//                var theta = alpha * index;
//                var pointx  =  Math.floor(Math.cos( theta + angle) * radius);
//                var pointy  = Math.floor(Math.sin( theta + angle) * radius );
//
//                $(this).css('margin-left', pointx + x + 'px');
//                $(this).css('margin-top', pointy + y + 'px');
//            });
//        }
//
//        function moveByCircle(){
//            var angle = 90;
//            drawCircle('.box', 50, 200, angle, 310, 220);
//            $("#movebtn").on('click', function() {
//                angle = angle + 5;
//                drawCircle('.box', 50, 200, angle, 310, 220);
//            });



        function setAngle(angle, x, y){
            var radius = 50;
            var alpha = Math.PI * 2;
            angle *= Math.PI / 180;
            var theta = alpha;

            var pointx  =  Math.floor(Math.cos( theta + angle) * radius);
            var pointy  = Math.floor(Math.sin( theta + angle) * radius );


            var xx = pointx + x;
            var yy = pointy + y;

            moveTo(xx, yy);
        }

        function moveTo(x, y){
            var point = new Object();
            point.x = x;
            point.y = y;
            _moveQueue.push(point);
            moveNext();
        }

        function moveNext(){
            if(_isMoving || _moveQueue.length == 0) return;

            _nextPoint = dequeue();
            if(_nextPoint.x == _shipX && _nextPoint.y == _shipY){
                if(_moveQueue.length == 0) return;

                _nextPoint = dequeue();
            }

            var differenceBetweenXs = Math.abs(_nextPoint.x - _shipX);
            var differenceBetweenYs = Math.abs(_nextPoint.y - _shipY);
            var allIterations = differenceBetweenXs > differenceBetweenYs ?
                    differenceBetweenXs : differenceBetweenYs;
            var oneIterationXStep = differenceBetweenXs / allIterations;
            var oneIterationYStep = differenceBetweenYs / allIterations;
            var iterations = 0;

            _delay = 0;
            while(iterations != allIterations){
                iterations++;
                _delay += 3;

                setTimeout(function(){
                    MoveToNextPoint(oneIterationXStep, oneIterationYStep);
                }, _delay);
            }
        }

        function MoveToNextPoint(oneIterationXStep, oneIterationYStep){
            _shipX = makeCloser(_shipX, _nextPoint.x, oneIterationXStep);
            _shipY = makeCloser(_shipY, _nextPoint.y, oneIterationYStep);

            setCoordinates(_shipX, _shipY);

            if(isMovedToEnd())
            {
                finishMove();
            }
        }

        function setCoordinates(x, y){
            _shipX = x;
            _shipY = y;

            $('#myDiv').css("left", x);
            $('#myDiv').css("top", y);
        }

        function isMovedToEnd(){
            return _shipX == _nextPoint.x || _shipY == _nextPoint.y;
        }

        function finishMove(){
            _isMoving = false;
            moveNext();
        }

        function dequeue(){
            _isMoving = true;
            var result = _moveQueue[0];
            _moveQueue.splice(0, 1);

            return result;
        }

        function makeCloser(current, mustBe, closerValue){
            return current >= mustBe? current - closerValue : current + closerValue;
        }


    </script>
</head>
    <body>
        <!--<canvas id="myCanvas" width="288" height="288" />-->
        <img src="img/labyrinth.png" />
        <div id="myDiv" style="width: 30px; height: 30px; background-color: black; position: absolute;"></div>
    </body>
</html>
